type,name,path,schedule,auth_pattern,callers,notes,discovered_at
trigger,on_user_documents_blockchain_anchoring,supabase/migrations/20251221100000_blockchain_anchoring_trigger.sql,,current_setting('app.settings.supabase_url'|'app.settings.service_role_key') ,DB trigger (pg_net.http_post -> edge functions anchor-polygon/anchor-bitcoin),Invokes /functions/v1/anchor-polygon and /anchor-bitcoin via net.http_post; historically used current_setting('app.settings.service_role_key') causing NULL auth,2026-01-18T06:04:13.201Z
trigger,update_user_documents_updated_at,supabase/migrations/20251115220000_007_user_documents.sql,,DB trigger,Maintains updated_at on user_documents; multiple triggers exist in migrations,2026-01-18T06:04:13.201Z
cron,process-polygon-anchors,supabase/functions/process-polygon-anchors/cron.sql,*/1 * * * *,Authorization: Bearer || current_setting('app.settings.service_role_key') or x-cron-secret,cron scheduler -> supabase function process-polygon-anchors; confirms Polygon TXs and appends events[],Multiple helper SQL/scripts to create/repair cron; function also validates x-cron-secret,2026-01-18T06:04:13.201Z
cron,process-bitcoin-anchors,supabase/functions/process-bitcoin-anchors/cron.sql,*/5 * * * *,Authorization: Bearer || current_setting('app.settings.service_role_key') or x-cron-secret,cron scheduler -> supabase function process-bitcoin-anchors; processes OTS/Bitcoin,Has retries/backoff; migration scripts present to recreate cron,2026-01-18T06:04:13.201Z
cron,recover-orphan-anchors,supabase/migrations/20251221100002_orphan_recovery_cron.sql,*/5 * * *,Authorization: Bearer || current_setting('app.settings.service_role_key'),cron scheduler -> recover-orphan-anchors safety net,Detects and repairs orphan anchors; recovery safety net,2026-01-18T06:04:13.201Z
cron,send-pending-emails,scripts/cron/setup-all-crons.sql,*/1 * * * *,x-cron-secret,cron scheduler -> supabase/functions/send-pending-emails,Email worker cron; ensure Resend/MAIL envs set,2026-01-18T06:04:13.201Z
edge,anchor-polygon,supabase/functions/anchor-polygon/index.ts,,invoked by trigger|client|signnow-webhook|process-signature,Creates anchor record (polygon) and enqueues tx; historically lacked some hash validation; invoked by multiple callers,2026-01-18T06:04:13.201Z
edge,anchor-bitcoin,supabase/functions/anchor-bitcoin/index.ts,,invoked by trigger|client|signnow-webhook|process-signature,Creates/queues Bitcoin/OTS anchor; validates 64-hex hash; worker process-bitcoin-anchors does submission/confirmation,2026-01-18T06:04:13.201Z
edge,process-polygon-anchors,supabase/functions/process-polygon-anchors/index.ts,cron (*/1 * * * *),x-cron-secret (in function) or Authorization,Confirmer worker invoked by cron; confirms TX receipts and appends canonical events[],Has legacy variants in _legacy; needs atomic UPDATES to avoid 409s,2026-01-18T06:04:13.201Z
edge,process-bitcoin-anchors,supabase/functions/process-bitcoin-anchors/index.ts,cron (*/5 * * * *),x-cron-secret (in function) or Authorization,Confirmer worker invoked by cron; batches to OpenTimestamps and verifies confirmations,Tracks attempts/backoff; 289 attempts observed on some rows,2026-01-18T06:04:13.201Z
edge,notify-artifact-ready,supabase/functions/notify-artifact-ready/index.ts,,x-cron-secret,Used by workers/crons to notify UI/email when artifact ready; validates x-cron-secret header,2026-01-18T06:04:13.201Z
edge,health-check,supabase/functions/health-check/index.ts,,public/ops,Provides aggregated cron/anchoring health; callers: dashboards/ops,Inferences cron health from recent anchor activity; useful for monitoring,2026-01-18T06:04:13.201Z
edge,signnow-webhook,supabase/functions/signnow-webhook/index.ts,,external webhook -> invokes anchor-polygon/anchor-bitcoin,Webhook from SignNow that calls anchor functions; ensure auth/validation,2026-01-18T06:04:13.201Z
edge,process-signature,supabase/functions/process-signature/index.ts,,internal -> invokes anchor-polygon/anchor-bitcoin,Part of workflow; invokes anchors after processing a signature,2026-01-18T06:04:13.201Z
edge,legacy_anchor-polygon,supabase/functions/_legacy/anchor-polygon/index.ts,,legacy,Deprecated duplicate of anchor-polygon; keep for reference,2026-01-18T06:04:13.201Z
edge,legacy_process-polygon-anchors,supabase/functions/_legacy/process-polygon-anchors/index.ts,cron (legacy),legacy,Deprecated duplicate worker; exists for compatibility,2026-01-18T06:04:13.201Z
shared,_shared/cors,supabase/functions/_shared/cors.ts,,CORS/CORS_ALLOW envs,Shared CORS helper used by many edge functions; ALLOWED_ORIGIN and SITE_URL envs important to avoid browser blocks,2026-01-18T06:04:13.201Z
shared,_shared/anchorHelper.example,supabase/functions/_shared/anchorHelper.example.ts,,example helper,Examples for anchor flow and worker patterns; useful for refactor to executor,2026-01-18T06:04:13.201Z
